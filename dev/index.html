<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>UniversalDiffEq.jl · UniversalDiffEq.jl</title><meta name="title" content="UniversalDiffEq.jl · UniversalDiffEq.jl"/><meta property="og:title" content="UniversalDiffEq.jl · UniversalDiffEq.jl"/><meta property="twitter:title" content="UniversalDiffEq.jl · UniversalDiffEq.jl"/><meta name="description" content="Documentation for UniversalDiffEq.jl."/><meta property="og:description" content="Documentation for UniversalDiffEq.jl."/><meta property="twitter:description" content="Documentation for UniversalDiffEq.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>UniversalDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>UniversalDiffEq.jl</a><ul class="internal"><li><a class="tocitem" href="#Universal-dynamic-equations"><span>Universal dynamic equations</span></a></li><li><a class="tocitem" href="#How-UniversalDiffEq.jl-works"><span>How UniversalDiffEq.jl works</span></a></li><li><a class="tocitem" href="#Data-types"><span>Data types</span></a></li><li><a class="tocitem" href="#Package-Contents"><span>Package Contents</span></a></li></ul></li><li><a class="tocitem" href="Models/">Model Constructors</a></li><li><a class="tocitem" href="EasyModels/">Easy NODE and UDE</a></li><li><a class="tocitem" href="ModelTesting/">Test models</a></li><li><a class="tocitem" href="NutsAndBolts/">UDE model construction</a></li><li><a class="tocitem" href="MultipleTimeSeries/">Fitting a model to multiple time series</a></li><li><a class="tocitem" href="modelanalysis/">Model analysis</a></li><li><a class="tocitem" href="BayesianModels/">Bayesian Models</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>UniversalDiffEq.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>UniversalDiffEq.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="UniversalDiffEq.jl"><a class="docs-heading-anchor" href="#UniversalDiffEq.jl">UniversalDiffEq.jl</a><a id="UniversalDiffEq.jl-1"></a><a class="docs-heading-anchor-permalink" href="#UniversalDiffEq.jl" title="Permalink"></a></h1><p>UniversalDiffEq.jl is a library for building state-space universal dynamic equations (SS-UDEs), nonlinear time series models that learn unknown nonlinear relationships in time series data using neural networks. The package provides model constructor functions to build discrete and continuous time models that combine known parametric functions with unknown functions represented by neural networks. UniversalkDiffEq.jl defines a set of training procedures that can simultaneously estimate the parameters of known functions and train a neural network to represent unknown functions. The models are trained using a state space modeling procedure, which makes them robust to stochastic variability and measurement errors. The package uses Lux.jl to define the neural networks and DiffEqFlux.jl to train neural networks embedded within continuous time models. </p><h2 id="Universal-dynamic-equations"><a class="docs-heading-anchor" href="#Universal-dynamic-equations">Universal dynamic equations</a><a id="Universal-dynamic-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Universal-dynamic-equations" title="Permalink"></a></h2><p>Universal dynamic equations include two classes of models: universal differential equations and universal difference equations. Universal differential equations are continuous-time models that learn the right-hand side of a system of ordinary differential equations from time series data</p><p class="math-container">\[\frac{du}{dt} = f(u).\]</p><p>Universal difference equations are discrete-time models that learn the right-hand side of a system of difference equations</p><p class="math-container">\[u_{t+1} = u_{t} + f(u).\]</p><p>In the simplest case, a neural network <span>$NN$</span> represents the entire right-hand side of the model <span>$f(\bfmath{x}) = NN(\bfmath{x})$</span>. However, in general, the right-hand side of the model can include both neural networks and parametric functions. For example, the classic Loka Volterra predator-prey model includes a growth term for the prey <span>$rN$</span>, a mortality rate for the predator <span>$mN$</span>, and a linear interaction term between the two species <span>$\alpha NP$</span>. We can use universal differential equations to build a more flexible version of this model by replacing the linear interaction term with a neural network </p><p class="math-container">\[\frac{dN}{dt} = rN - NN(N,P) \\
\frac{dP}{dt} = \theta NN(N,P) - mP.\]</p><p>We can train the neural network <span>$NN$</span> and estimate the biological parameters <span>$r$</span>, <span>$m$</span>, and <span>$\theta$</span> from time series data using the training routines defined in UniversalDiffEq.jl.</p><h2 id="How-UniversalDiffEq.jl-works"><a class="docs-heading-anchor" href="#How-UniversalDiffEq.jl-works">How UniversalDiffEq.jl works</a><a id="How-UniversalDiffEq.jl-works-1"></a><a class="docs-heading-anchor-permalink" href="#How-UniversalDiffEq.jl-works" title="Permalink"></a></h2><p>UniversalDiffEq.jl builds and trains universal dynamic equations within a state-space modeling framework. State-space models describe noisy time series data by combining two models: (1) an observation model that describes the relationship between the data and the actual underlying state of the system and (2) a process model that describes the changes in the system&#39;s state over time. This model structure allows state-space models to account for uncertainty caused by noisy observations (observation error) and inherent randomness within the system&#39;s dynamics (process error).</p><p>State-space models simultaneously estimate the parameters of the process and observation models <span>$\theta$</span> and the value of the state variables at each point in time <span>$\hat{u}_t$</span>. These parameters are estimated by optimizing a loss function that combines two components: the observation loss and the process loss. The observation loss compares the state estimates to the data <span>$y_t$</span> using the observaiton model <span>$g(u_t)$</span></p><p class="math-container">\[L_{obs} = \frac{1}{T} \sum_{i = 1}^T (y_t - g(\hat{u}_t;\theta ))^2.\]</p><p>The process loss compares predictions of the process model <span>$f(u_t;\theta)$</span> to the estimated states variables at the next time point</p><p class="math-container">\[L_{proc} = \frac{1}{T-1} \sum_{i = 2}^T\frac{1}{\Delta t}(\hat{u}_t - f(\hat{u}_{t-1};\theta ))^2.\]</p><p>The process loss is weighted by the inverse of the time between data points <span>$\Delta t$</span>. </p><p>In addition to the process and observaiton loss additional terms can be added to the loss funciton to regularize the neuarl network parmaters and to incorperate prior informaiton about the parameters of parametric functions</p><p class="math-container">\[L_{reg} = R(\theta).\]</p><p>The UniversalDiffEq.jl package combines weighted sums of these three components to create the full loss function</p><p class="math-container">\[L(\hat{u},\theta) = \omega_{obs} L_{obs} + \omega_{proc} L_{proc} + \omega_{reg} L_{reg}.\]</p><p>UniversalDiffEq.jl uses Optimizers.jl to find the state and parameter estimates that minimize the loss function. Currently, two optimization algorithms are available, the Adam gradient descent algorithm and the quasi-Newton algorithm BFGS.</p><h2 id="Data-types"><a class="docs-heading-anchor" href="#Data-types">Data types</a><a id="Data-types-1"></a><a class="docs-heading-anchor-permalink" href="#Data-types" title="Permalink"></a></h2><p>UniversalDiffEq.jl can train models on individual time series <span>$y_t$</span> or panel of mutliple time series <span>$y_{i,t}$</span> from systmes with similar dynamics. Seperate model constructors are provided for models trained on single and multiple time series.UniversalDiffEq.jl even allows the model to include paramters that have duiffernt value for each time series in the training set. </p><p>UniversalDiffEq.jl can accomidate irregualrly sampled data. Data for continuous time models can be sampled at any point in time, while discrete tiem models requre and integer valued time steps between observations. UniversalDiffEq.jl does not accomidate observaitons that are missing a sub set of the state variables.</p><p>Models built with UniversalDiffEq.jl can incorperate covariates <span>$X_t$</span> that influence the dynamics of the primary state variables. Discrete time models require the the observations of the covariates to match the time when the state variables are observed </p><h2 id="Package-Contents"><a class="docs-heading-anchor" href="#Package-Contents">Package Contents</a><a id="Package-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Contents" title="Permalink"></a></h2><ul><li><a href="Models/#Model-Constructors">Model Constructors</a></li><li class="no-marker"><ul><li><a href="Models/#Nonparametric-UDES-(Neural-Ordinary-differntial-equation)">Nonparametric UDES (Neural Ordinary differntial equation)</a></li><li><a href="Models/#Customizing-universal-dynamic-equaitons">Customizing universal dynamic equaitons</a></li><li><a href="Models/#Adding-covariates">Adding covariates</a></li><li><a href="Models/#Adding-prior-information-to-custom-models">Adding prior information to custom models</a></li></ul></li><li><a href="ModelTesting/#Test-models">Test models</a></li><li class="no-marker"><ul><li><a href="ModelTesting/#Evaluating-model-fits">Evaluating model fits</a></li><li><a href="ModelTesting/#Cross-validation">Cross-validation</a></li></ul></li><li><a href="MultipleTimeSeries/#Fitting-a-model-to-multiple-time-series">Fitting a model to multiple time series</a></li><li class="no-marker"><ul><li><a href="MultipleTimeSeries/#Dataframe">Dataframe</a></li></ul></li><li><a href="NutsAndBolts/#UDE-model-construction">UDE model construction</a></li><li><a href="modelanalysis/#Model-analysis">Model analysis</a></li><li><a href="examples/#Examples">Examples</a></li><li class="no-marker"><ul><li><a href="examples/#Using-time-dependent-NODEs-to-predict-regime-changes">Using time-dependent NODEs to predict regime changes</a></li><li><a href="examples/#Using-UDEs-to-learn-the-dynamics-of-coupled-human-natural-systems">Using UDEs to learn the dynamics of coupled human-natural systems</a></li></ul></li><li><a href="API/#API">API</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="Models/">Model Constructors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 6 September 2024 17:37">Friday 6 September 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
