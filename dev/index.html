<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>UniversalDiffEq.jl · UniversalDiffEq.jl</title><meta name="title" content="UniversalDiffEq.jl · UniversalDiffEq.jl"/><meta property="og:title" content="UniversalDiffEq.jl · UniversalDiffEq.jl"/><meta property="twitter:title" content="UniversalDiffEq.jl · UniversalDiffEq.jl"/><meta name="description" content="Documentation for UniversalDiffEq.jl."/><meta property="og:description" content="Documentation for UniversalDiffEq.jl."/><meta property="twitter:description" content="Documentation for UniversalDiffEq.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>UniversalDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>UniversalDiffEq.jl</a><ul class="internal"><li><a class="tocitem" href="#Universal-differential-equations"><span>Universal differential equations</span></a></li><li><a class="tocitem" href="#How-UniversalDiffEq.jl-works"><span>How UniversalDiffEq.jl works</span></a></li><li><a class="tocitem" href="#Package-Contents"><span>Package Contents</span></a></li></ul></li><li><a class="tocitem" href="Models/">Model Constructors</a></li><li><a class="tocitem" href="EasyModels/">Easy NODE and UDE</a></li><li><a class="tocitem" href="ModelTesting/">Test models</a></li><li><a class="tocitem" href="NutsAndBolts/">UDE model construction</a></li><li><a class="tocitem" href="MultipleTimeSeries/">Fitting a model to multiple time series</a></li><li><a class="tocitem" href="modelanalysis/">Model analysis</a></li><li><a class="tocitem" href="BayesianModels/">Bayesian Models</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>UniversalDiffEq.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>UniversalDiffEq.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="UniversalDiffEq.jl"><a class="docs-heading-anchor" href="#UniversalDiffEq.jl">UniversalDiffEq.jl</a><a id="UniversalDiffEq.jl-1"></a><a class="docs-heading-anchor-permalink" href="#UniversalDiffEq.jl" title="Permalink"></a></h1><p>A library for building nonlinear time series models for ecological data with neural networks. UniversalDiffEq.jl uses the Lux.jl and DiffEqFlux.jl libraries to construct time series models and defines a set of training procedures designed to handle common problems with ecological data, like sparse and noisy observations.</p><h2 id="Universal-differential-equations"><a class="docs-heading-anchor" href="#Universal-differential-equations">Universal differential equations</a><a id="Universal-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Universal-differential-equations" title="Permalink"></a></h2><p>UniversalDiffEq.jl builds universal differential equations (UDEs), a class of models that uses neural networks to learn a differential equation. For example, we can build a model that uses a neural network to learn the right-hand side of a system of differential equations</p><p class="math-container">\[\frac{dx}{dt} = NN(x).\]</p><p>It is also possible to create models that combine neural networks with known functional forms. For example, we might use a neural network to learn the interaction term in a predator-prey model based on the Lotka-Volterra equations</p><p class="math-container">\[\frac{dN}{dt} = rN - NN(N,P) \\
\frac{dP}{dt} = \theta NN(N,P) - mP.\]</p><p>UniversalDiffEq.jl also provides functions to construct models based on difference equations</p><p class="math-container">\[x_{t+1} = NN(x).\]</p><h2 id="How-UniversalDiffEq.jl-works"><a class="docs-heading-anchor" href="#How-UniversalDiffEq.jl-works">How UniversalDiffEq.jl works</a><a id="How-UniversalDiffEq.jl-works-1"></a><a class="docs-heading-anchor-permalink" href="#How-UniversalDiffEq.jl-works" title="Permalink"></a></h2><p>UniversalDiffEq.jl builds and trains UDEs within a state-space modeling framework. State-space models describe noisy time series data by combining two models: (1) an observation model that describes the relationship between the data and the true underlying state of the system, and (2) a process model that describes the changes in the system&#39;s state over time. This model structure allows state-space models to account for uncertainty caused by noisy observations (observation error) and inherent randomness within the system&#39;s dynamics (process error).</p><p>State-space models simultaneously estimate the parameters of the process and observation models <span>$\theta$</span> and the value of the state variables at each point in time <span>$\hat{u}_t$</span>. These parameters are estimated by optimizing a loss function that combines two components, the observation loss and the process loss, which evaluate the performance of the state estimates and the process model parameters, respectively. The observation loss compares the state estimates <span>$\hat{u}_t$</span> to the data <span>$x_t$</span> using the observation model <span>$g(u_t)$</span>. For example, we can use the mean squared error loss</p><p class="math-container">\[L_{obs} = \frac{1}{T} \sum_{i = 1}^T (x_t - g(\hat{u}_t;\theta ))^2.\]</p><p>The process loss is calculated by comparing the predictions of the process model <span>$f(u_t;\theta)$</span> to the estimated states one step ahead again. The mean squared error performs well</p><p class="math-container">\[L_{proc} = \frac{1}{T-1} \sum_{i = 2}^T(\hat{u}_t - f(\hat{u}_{t-1};\theta ))^2.\]</p><p>Additional terms can be added to regularize neural network parameters or incorporate prior information</p><p class="math-container">\[L_{reg} = R(\theta).\]</p><p>The UniversalDiffEq.jl package combines weighted sums of these three components to create the full loss function</p><p class="math-container">\[L(\hat{u},\theta) = \omega_{obs} L_{obs} + \omega_{proc} L_{proc} + \omega_{reg} L_{reg}.\]</p><p>UniversalDiffEq.jl uses Optimizers.jl to find the state and parameter estimates that minimize the loss function. Currently, two optimization algorithms are available, the Adam gradient descent algorithm and the quasi-Newton algorithm BFGS.</p><h2 id="Package-Contents"><a class="docs-heading-anchor" href="#Package-Contents">Package Contents</a><a id="Package-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Contents" title="Permalink"></a></h2><ul><li><a href="Models/#Model-Constructors">Model Constructors</a></li><li class="no-marker"><ul><li><a href="Models/#NODEs-and-NNDE">NODEs and NNDE</a></li><li><a href="Models/#UDEs">UDEs</a></li><li><a href="Models/#Adding-covariates">Adding covariates</a></li><li><a href="Models/#Adding-prior-information-to-custom-models">Adding prior information to custom models</a></li></ul></li><li><a href="ModelTesting/#Test-models">Test models</a></li><li class="no-marker"><ul><li><a href="ModelTesting/#Evaluating-model-fits">Evaluating model fits</a></li><li><a href="ModelTesting/#Cross-validation">Cross-validation</a></li></ul></li><li><a href="MultipleTimeSeries/#Fitting-a-model-to-multiple-time-series">Fitting a model to multiple time series</a></li><li class="no-marker"><ul><li><a href="MultipleTimeSeries/#Dataframe">Dataframe</a></li></ul></li><li><a href="NutsAndBolts/#UDE-model-construction">UDE model construction</a></li><li><a href="modelanalysis/#Model-analysis">Model analysis</a></li><li><a href="examples/#Examples">Examples</a></li><li class="no-marker"><ul><li><a href="examples/#Using-time-dependent-NODEs-to-predict-regime-changes">Using time-dependent NODEs to predict regime changes</a></li><li><a href="examples/#Using-UDEs-to-learn-the-dynamics-of-coupled-human-natural-systems">Using UDEs to learn the dynamics of coupled human-natural systems</a></li></ul></li><li><a href="API/#API">API</a></li><li class="no-marker"><ul><li><a href="API/#Need-Documentation">Need Documentation</a></li></ul></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="Models/">Model Constructors »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 26 August 2024 21:48">Monday 26 August 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
