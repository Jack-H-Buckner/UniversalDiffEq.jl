<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Test models · UniversalDiffEq.jl</title><meta name="title" content="Test models · UniversalDiffEq.jl"/><meta property="og:title" content="Test models · UniversalDiffEq.jl"/><meta property="twitter:title" content="Test models · UniversalDiffEq.jl"/><meta name="description" content="Documentation for UniversalDiffEq.jl."/><meta property="og:description" content="Documentation for UniversalDiffEq.jl."/><meta property="twitter:description" content="Documentation for UniversalDiffEq.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">UniversalDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">UniversalDiffEq.jl</a></li><li><a class="tocitem" href="../Models/">Model Constructors</a></li><li><a class="tocitem" href="../EasyModels/">Easy NODE and UDE</a></li><li class="is-active"><a class="tocitem" href>Test models</a><ul class="internal"><li><a class="tocitem" href="#Evaluating-model-fits"><span>Evaluating model fits</span></a></li><li><a class="tocitem" href="#Cross-validation"><span>Cross-validation</span></a></li></ul></li><li><a class="tocitem" href="../NutsAndBolts/">UDE model construction</a></li><li><a class="tocitem" href="../MultipleTimeSeries/">Fitting a model to multiple time series</a></li><li><a class="tocitem" href="../modelanalysis/">Model analysis</a></li><li><a class="tocitem" href="../BayesianModels/">Bayesian Models</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Test models</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Test models</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/main/docs/src/ModelTesting.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Test-models"><a class="docs-heading-anchor" href="#Test-models">Test models</a><a id="Test-models-1"></a><a class="docs-heading-anchor-permalink" href="#Test-models" title="Permalink"></a></h1><p>UniversalDiffEq.jl provides a number of functions to test the performance of NODE and UDE models, with both in-sample and out-of-sample data. </p><h2 id="Evaluating-model-fits"><a class="docs-heading-anchor" href="#Evaluating-model-fits">Evaluating model fits</a><a id="Evaluating-model-fits-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluating-model-fits" title="Permalink"></a></h2><p>There are two primary functions to test model fits: <code>plot_state_estimates</code> and <code>plot_predictions</code>. The model fitting procedure estimates the value of the state variables <span>$\hat{u}$</span> at each time point in the data set as well as the parameters of the NODE or UDE model that predicts changes in the state variables. The <code>plot_state_estimates</code> function compares the estimated states to the data to check the quality of the state estimates, and <code>plot_predictions</code> compares the predictions of UDE model one step into the future to the estimated sequence of state variables. Both functions take a UDE as an input and return a plot showing the correspondence between model predictions and observations. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.plot_state_estimates-Tuple{UDE}-ModelTesting" href="#UniversalDiffEq.plot_state_estimates-Tuple{UDE}-ModelTesting"><code>UniversalDiffEq.plot_state_estimates</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot_state_estimates(UDE::UDE)</code></pre><p>Plots the values of the state variables estimated by the UDE model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/beb7cde55a85b3b6705d259f1edcdbc9b1d07435/src/ModelTesting.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.plot_predictions-Tuple{UDE}-ModelTesting" href="#UniversalDiffEq.plot_predictions-Tuple{UDE}-ModelTesting"><code>UniversalDiffEq.plot_predictions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot_predictions(UDE::UDE)</code></pre><p>Plots the correspondence between the observed state transitions and the predictions from the UDE model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/beb7cde55a85b3b6705d259f1edcdbc9b1d07435/src/ModelTesting.jl#L249-L254">source</a></section></article><p>There are also functions to compare the model predictions to out-of-sample data. The simplest is <code>plot_forecast</code>, which compares the observations in the test data set to a deterministic simulation from the data set, which starts at the first observation and runs to the end of the test data. </p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.plot_forecast-Tuple{UDE, DataFrame}-ModelTesting" href="#UniversalDiffEq.plot_forecast-Tuple{UDE, DataFrame}-ModelTesting"><code>UniversalDiffEq.plot_forecast</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot_forecast(UDE::UDE, test_data::DataFrame)</code></pre><p>Plots the model&#39;s forecast over the range of the test data along with the value of the test data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/beb7cde55a85b3b6705d259f1edcdbc9b1d07435/src/ModelTesting.jl#L588-L592">source</a></section></article><p>It is also possible to test the performance of the models one time step into the future using the <code>plot_predictions</code> function. When a test data set is supplied to the <code>plot_predictions</code> function, it will run a series of forecasts starting at each point in the data set, predicting one time step into the future. The function returns a plot comparing the predicted and observed changes.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.plot_predictions-Tuple{UDE, DataFrame}-ModelTesting" href="#UniversalDiffEq.plot_predictions-Tuple{UDE, DataFrame}-ModelTesting"><code>UniversalDiffEq.plot_predictions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">plot_predictions(UDE::UDE, test_data::DataFrame)</code></pre><p>Plots the correspondence between the observed state transitions in test data and the predictions from the UDE model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/beb7cde55a85b3b6705d259f1edcdbc9b1d07435/src/ModelTesting.jl#L313-L317">source</a></section></article><h2 id="Cross-validation"><a class="docs-heading-anchor" href="#Cross-validation">Cross-validation</a><a id="Cross-validation-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-validation" title="Permalink"></a></h2><p>Cross-validation is important for model comparison and hyper-parameter tuning. The <code>leave_future_out_cv</code> function breaks the data set into training and test data sets by leaving off the final observations in the data set. The model is then trained on the beginning of the data set and the performance is calculated by comparing a forecast to the test data. The user can specify the time horizon for the forecast <span>$T_{Forecast}$</span> and the number of tests <span>$K$</span>. The first test trains the model on the full data set only omitting the final <span>$T_{forecast}$</span> years as the test set. The remaining tests each generate a new test data set by iteratively removing more of the observations from the end of the data set. The number removed between each test can be controlled by changing the spacing argument. The <code>kfold_cv</code> function performs a k-fold version of <code>leave_future_out_cv</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.leave_future_out_cv-Tuple{UDE}-ModelTesting" href="#UniversalDiffEq.leave_future_out_cv-Tuple{UDE}-ModelTesting"><code>UniversalDiffEq.leave_future_out_cv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">leave_future_out_cv(model::UDE; kwargs ...)</code></pre><p>Runs K fold leave future out cross validation and returns the mean squared forecasting error and a plot to visualize the model fits.</p><p>...</p><p><strong>Arguments</strong></p><p>model - the UDE model to test forecast<em>length = 5 - The number of data points to forecast forecast</em>number = 10 - The number of trainin gnad testing data sets to create spacing = 2 - The number of data points to skip between the end of each new triaining data set BFGS=false - use BFGS algorithm to train the model step<em>size = 0.05 - step size for first run of the ADAM algorithm  maxiter = 500 - maximum iterations for first trial of ADAM step</em>size2 = 0.01 - step size for second iteration of ADAM, only used of BFGS is false maxiter2 = 500 - step size for second iteration of ADAM, only used of BFGS is false ...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/beb7cde55a85b3b6705d259f1edcdbc9b1d07435/src/CrossValidation.jl#L174-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.kfold_cv-Tuple{UDE}-ModelTesting" href="#UniversalDiffEq.kfold_cv-Tuple{UDE}-ModelTesting"><code>UniversalDiffEq.kfold_cv</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">kfold_cv(model::UDE; kwargs ...)</code></pre><p>Runs K fold leave future out cross validation and returns the mean squared forecasting error and a plot to visualize the model fits.</p><p>...</p><p><strong>Arguments</strong></p><p>model - a UDE model object k=10 - the number of testing and taining data sets to build leave<em>out=5 - the number of data points to leave out in each testingdata set BFGS = false - use the BFGS algorithm to train the model step</em>size = 0.05 - step size for first run of the ADAM algorithm  maxiter = 500 - maximum iterations for first trial of ADAM step_size2 = 0.01 - step size for second iteration of ADAM, only used of BFGS is false maxiter2 = 500 - step size for second iteration of ADAM, only used of BFGS is false ...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/beb7cde55a85b3b6705d259f1edcdbc9b1d07435/src/CrossValidation.jl#L80-L96">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../EasyModels/">« Easy NODE and UDE</a><a class="docs-footer-nextpage" href="../NutsAndBolts/">UDE model construction »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Wednesday 11 September 2024 13:02">Wednesday 11 September 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
