<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>UDE model construction · UniversalDiffEq.jl</title><meta name="title" content="UDE model construction · UniversalDiffEq.jl"/><meta property="og:title" content="UDE model construction · UniversalDiffEq.jl"/><meta property="twitter:title" content="UDE model construction · UniversalDiffEq.jl"/><meta name="description" content="Documentation for UniversalDiffEq.jl."/><meta property="og:description" content="Documentation for UniversalDiffEq.jl."/><meta property="twitter:description" content="Documentation for UniversalDiffEq.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">UniversalDiffEq.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">UniversalDiffEq.jl</a></li><li><a class="tocitem" href="../Models/">Model Constructors</a></li><li><a class="tocitem" href="../ModelTesting/">Test models</a></li><li class="is-active"><a class="tocitem" href>UDE model construction</a></li><li><a class="tocitem" href="../MultipleTimeSeries/">Fitting a model to multiple time series</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>UDE model construction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>UDE model construction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/main/docs/src/NutsAndBolts.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="UDE-model-construction"><a class="docs-heading-anchor" href="#UDE-model-construction">UDE model construction</a><a id="UDE-model-construction-1"></a><a class="docs-heading-anchor-permalink" href="#UDE-model-construction" title="Permalink"></a></h1><p>Some users may wish to access elements of a fitted model directly to create custom model visualizations, performance tests, or other applications not forseen by thr developers. To this end, we provide documentation of classes (Julia mutable structs) used by UniversalDiffEq.jl to build the NODE and UDE objects. The package is built around the <code>UDE</code> class which stores the data used to fit a model and instances of six submodel classes used to define the full model. </p><p>UniversalDiffEq uses a state space modeling framework to define and fit NODE and UDE models. State space models are a class of time series models that describe a time series data with a process model that describes the dynaics of a sequence of unobserved state variables <span>$u_t$</span> a second observaiton model defines the relationship between the state variables <span>$u_t$</span> and the observations <span>$x_t$</span>.  The process model <span>$f$</span> predicts value of the state variables one step ahead</p><p class="math-container">\[\hat{u}_{t+\Delta t } = f(u_t; t, \Delta t, \theta_{proc})\]</p><p>where <span>$\Delta t$</span> is the time span between observations, and <span>$\theta_{proc}$</span> is the model paramters. The observaiton model maps from the state variables <span>$u_t$</span> to the observations</p><p class="math-container">\[x_{t} = h(u_t; t, \Delta t, \theta_{obs})\]</p><p>where <span>$\theta_{obs}$</span> are the observaiton model parameters. In addition to these primary functions both the observaiton models and process models have loss funtion to measure the accuracy of thier predictions. These can be thought of like the likelihood models used in generalized linear models. for example, we can measure the perforance of the process model with a normal likelihood</p><p class="math-container">\[L(\hat{u}_t,u_t) = \frac{1}{\sigma \sqrt{2\pi}} e^{-\frac{1}{2}(\frac{\hat{u}_t-u_t}{\sigma})^2}\]</p><p>where <span>$\sigma$</span> is the variance of the prediciton errors. Although in principal any likelihood can be used, we use the mean squared error in our base model specification. </p><p>The UDE models also include submodels to regualrize the process and observaiton models. The regualrization models are functions of the model parameters that add to the loss funtion. The regularizaiton models are ineffect priors on the model parameters. Regularization in expecially important for nerual network models. For example, out default model constructors apply <code>L2</code> regualrizaiton to neuarl network paramters in the process model</p><p class="math-container">\[R(\theta_{proc}) = \omega ||\theta_{proc}||_{L2}\]</p><p>where <span>$\omega$</span> is the weight given to regualrization in the over all loss function. </p><p>These six model components are all combined into one loss functions used to fit the UDE models</p><p class="math-container">\[L(u,\theta_{proc},\theta_{obs};x) = \sum_{t =1}^{T} L_{obs}(x_t,h(u_t,\theta_{obs});\sigma_{obs}) + \sum_{t=2}^{T} L_{proc}(u_t,f(u_{t-1},\theta_{proc});\sigma_{proc}) + R_{obs}(\theta_{obs}) + R_{proc}(\theta_{proc}).\]</p><p>where the <span>$\sigma_i$</span> are paramters for the loss functions and the <span>$\theta_i$</span> are paramters for the prediction functions. </p><p>The UDE object combines the observation and process models and their rpective loss and regualrization models into one larger model object along with the data used to fit the model.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.UDE" href="#UniversalDiffEq.UDE"><code>UniversalDiffEq.UDE</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UDE</code></pre><p>Basic data structure used to the model structure, parameters and data for UDE and NODE models.  ...</p><p><strong>Elements</strong></p><ul><li>times: a vector of times for each observation</li><li>data: a matrix of observaitons at each time point</li><li>X: a DataFrame with any covariates used by the model</li><li>data_frame: a DataFrame with colums for the time of each observation and values of the state variables</li><li>parameters: a ComponentArray that stores model parameters</li><li>loss_function: the loss function used to fit the model</li><li>process_model: a Julia mutable struct used to define model predictions </li><li>process_loss: a Julia mutable struct used to measure the peroance of model predictions</li><li>observation_model: a Julia mutable struct used to predict observaitons given state variable estiamtes</li><li>observaiton_loss: a Julia mutable struct used to measure the performance of the observaiton model</li><li>process_regularization: a Julia mutable struct used to store data needed for process model regularization</li><li>observation_regularization: a Julia mutable struct used to store data needed for observation model regularization</li><li>constructor: A function that initializes a UDE model with identical structure. </li></ul><p>...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/71e5995badaed40bfe48cb3cc115d889c46869da/src/Models.jl#L2-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.ProcessModel" href="#UniversalDiffEq.ProcessModel"><code>UniversalDiffEq.ProcessModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ProcessModel</code></pre><p>A Julia mutable struct that stores the functions and parameters for the process model.  ...</p><p><strong>Elements</strong></p><ul><li>parameters: ComponentArray</li><li>predict: Function the predict one time step ahead</li><li>forecast: Function, a modified version of rpedict to imporve performace when extrapolating</li><li>covariates: Function that returns the value of the covariates at each point in time. </li></ul><p>...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/71e5995badaed40bfe48cb3cc115d889c46869da/src/ProcessModels.jl#L27-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.LossFunction" href="#UniversalDiffEq.LossFunction"><code>UniversalDiffEq.LossFunction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LossFunction</code></pre><p>A Julia mutable struct that stores the loss function and parameters. ...</p><p><strong>Elements</strong></p><ul><li>parameters: ComponentArray</li><li>loss: Function </li></ul><p>...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/71e5995badaed40bfe48cb3cc115d889c46869da/src/LossFunctions.jl#L2-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="UniversalDiffEq.Regularization" href="#UniversalDiffEq.Regularization"><code>UniversalDiffEq.Regularization</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Regularization</code></pre><p>A Julia mutable struct that stores the loss function and parameters. ...</p><p><strong>Elements</strong></p><ul><li>reg_parameters: ComponentArray</li><li>loss: Function </li></ul><p>...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jack-H-Buckner/UniversalDiffEq.jl/blob/71e5995badaed40bfe48cb3cc115d889c46869da/src/Regularization.jl#L2-L11">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ModelTesting/">« Test models</a><a class="docs-footer-nextpage" href="../MultipleTimeSeries/">Fitting a model to multiple time series »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Thursday 14 March 2024 18:56">Thursday 14 March 2024</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
